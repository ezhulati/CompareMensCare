---
import {
  Heart,
  Sparkles,
  Activity,
  TrendingDown,
  Brain,
  Stethoscope,
  UserPlus,
  ArrowLeftRight,
  DollarSign,
  Shield,
  ShieldCheck,
  Zap,
  CircleDollarSign,
  Lock,
  Clock,
  Layers,
  Target,
  TrendingUp,
  Microscope,
  BadgeCheck,
  Package,
  Pill,
  Users,
  Headphones,
  Award,
  Calendar,
  BarChart,
  TestTube,
  FileText,
  Search,
  Moon,
  RefreshCw
} from 'lucide-astro';

interface Category {
  id: string;
  label: string;
  description: string;
}

const categories: Category[] = [
  {
    id: 'sexual-health',
    label: 'Sexual Health',
    description: 'ED treatments & sexual wellness',
  },
  {
    id: 'hair-health',
    label: 'Hair Health',
    description: 'Hair loss treatments',
  },
  {
    id: 'testosterone',
    label: 'Testosterone',
    description: 'TRT & hormone optimization',
  },
  {
    id: 'weight-loss',
    label: 'Weight Loss',
    description: 'GLP-1 & weight management',
  },
  {
    id: 'peptides',
    label: 'Peptide Therapy',
    description: 'Performance & recovery optimization',
  },
  {
    id: 'mental-health',
    label: 'Mental Health',
    description: 'Therapy & psychiatric care',
  },
  {
    id: 'diagnostics',
    label: 'Diagnostics',
    description: 'At-home health testing',
  },
  {
    id: 'sleep',
    label: 'Sleep & Insomnia',
    description: 'Sleep medications & support',
  },
  {
    id: 'herpes',
    label: 'Herpes Treatment',
    description: 'Outbreak management & prevention',
  },
];

const categoryIcons: Record<string, any> = {
  'sexual-health': Heart,
  'hair-health': Sparkles,
  'testosterone': Activity,
  'weight-loss': TrendingDown,
  'peptides': Zap,
  'mental-health': Brain,
  'diagnostics': Stethoscope,
  'sleep': Moon,
  'herpes': ShieldCheck,
};
---

<div class="guided-matcher bg-white rounded-3xl border border-slate-200 p-8 lg:p-12 shadow-sm">
  <!-- Progress Bar -->
  <div class="max-w-md mx-auto mb-8">
    <div class="flex items-center justify-between mb-2">
      <span class="text-sm font-medium text-slate-700">Question <span id="progress-current">1</span> of 3</span>
      <span class="text-sm text-slate-500"><span id="progress-percent">33</span>% complete</span>
    </div>
    <div class="h-2 bg-slate-100 rounded-full overflow-hidden">
      <div id="progress-bar" class="h-full bg-brand-accent transition-all duration-300" style="width: 33%"></div>
    </div>
  </div>

  <!-- Question 1: Category Selection -->
  <div id="question-1" class="question-step active">
    <div class="text-center mb-8 sm:mb-10">
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        Let's find what works for you
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">
        Whatever brought you here — we've helped thousands of guys in the same spot. Pick the area you're looking to improve:
      </p>
    </div>

    <div class="grid grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-4xl mx-auto">
      {categories.map((category) => {
        const IconComponent = categoryIcons[category.id];
        return (
          <button
            type="button"
            data-category={category.id}
            class="category-card group relative card-hover p-4 sm:p-5 lg:p-7 text-center cursor-pointer transition-all duration-200 focus-ring min-h-[160px] sm:min-h-[180px] flex flex-col items-center justify-center"
          >
            <div class="flex justify-center mb-3 sm:mb-4 text-brand-accent transition-transform duration-200 group-hover:scale-110">
              <IconComponent class="w-10 h-10 sm:w-11 sm:h-11 lg:w-12 lg:h-12" />
            </div>
            <h3 class="font-heading font-bold text-slate-900 mb-1.5 sm:mb-2 group-hover:text-brand-accent transition-colors text-base sm:text-lg lg:text-xl leading-tight">
              {category.label}
            </h3>
            <p class="text-xs sm:text-sm lg:text-base text-slate-600 leading-snug">
              {category.description}
            </p>
          </button>
        );
      })}
    </div>
  </div>

  <!-- ========== SEXUAL HEALTH FLOW ========== -->
  <!-- Q1.5: ED vs PE Differentiation -->
  <div id="question-1-5-sexual-health" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What brings you here?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">
        Let's make sure we're solving the right problem
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-sexual-health-type="ed" class="sexual-health-type-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><Heart class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Erectile Dysfunction (ED)</h3>
        <p class="text-sm text-slate-600 leading-snug">Difficulty getting or maintaining an erection</p>
      </button>
      <button type="button" data-sexual-health-type="pe" class="sexual-health-type-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><Clock class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Premature Ejaculation (PE)</h3>
        <p class="text-sm text-slate-600 leading-snug">Finishing too quickly, want more control</p>
      </button>
      <button type="button" data-sexual-health-type="both" class="sexual-health-type-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-green-600"><Layers class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Both ED and PE</h3>
        <p class="text-sm text-slate-600 leading-snug">Dealing with both issues together</p>
      </button>
    </div>
  </div>

  <!-- ED Flow (existing) -->
  <div id="question-2-sexual-health-ed" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        Where are you in this journey?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">
        No judgment — just need to know what kind of guidance will help most
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q2="novice" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-emerald-600">
          <UserPlus class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">This is New for Me</h3>
        <p class="text-sm text-slate-600 leading-snug">Never tried treatment — want to understand options</p>
      </button>
      <button type="button" data-q2="switching" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600">
          <ArrowLeftRight class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">My Current Service Isn't Cutting It</h3>
        <p class="text-sm text-slate-600 leading-snug">Used something before — need a better fit</p>
      </button>
      <button type="button" data-q2="value" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-emerald-600">
          <DollarSign class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">I Need This to Be Affordable</h3>
        <p class="text-sm text-slate-600 leading-snug">Can't keep spending this much long-term</p>
      </button>
    </div>
  </div>

  <div id="question-3-sexual-health-novice" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's your biggest concern right now?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Be honest — we'll match you accordingly</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="privacy-discretion" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-purple-600"><Shield class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Nobody Can Know About This</h3>
        <p class="text-sm text-slate-600 leading-snug">Discreet packaging, billing, zero paper trail</p>
      </button>
      <button type="button" data-q3="medical-credibility" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><ShieldCheck class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">I Need to Trust This is Safe</h3>
        <p class="text-sm text-slate-600 leading-snug">Real doctors, quality meds, no sketchy stuff</p>
      </button>
      <button type="button" data-q3="lowest-cost" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-emerald-600"><CircleDollarSign class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">I Can't Spend a Fortune</h3>
        <p class="text-sm text-slate-600 leading-snug">Need something that works without breaking the bank</p>
      </button>
      <button type="button" data-q3="easy-process" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-amber-600"><Zap class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Just Make This Simple</h3>
        <p class="text-sm text-slate-600 leading-snug">Quick consult, fast delivery, done</p>
      </button>
    </div>
  </div>

  <div id="question-3-sexual-health-switching" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's making you look elsewhere?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">You deserve better — let's find it</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="too-expensive" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-red-600"><TrendingUp class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">They're Bleeding Me Dry</h3>
        <p class="text-sm text-slate-600 leading-snug">This shouldn't cost this much every month</p>
      </button>
      <button type="button" data-q3="limited-options" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-indigo-600"><Layers class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">They Only Offer One Thing</h3>
        <p class="text-sm text-slate-600 leading-snug">Want to try different meds or doses</p>
      </button>
      <button type="button" data-q3="poor-support" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-orange-600"><Headphones class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Can't Get Help When I Need It</h3>
        <p class="text-sm text-slate-600 leading-snug">Customer service is non-existent</p>
      </button>
      <button type="button" data-q3="delivery-issues" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><Clock class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Shipping is Always Late</h3>
        <p class="text-sm text-slate-600 leading-snug">Need reliable, fast delivery I can count on</p>
      </button>
    </div>
  </div>

  <div id="question-3-sexual-health-value" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        How often will you actually use this?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Honest answer = best pricing fit</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3="occasionally" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-slate-600"><Clock class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Here and There</h3>
        <p class="text-sm text-slate-600 leading-snug">Special occasions, few times a month</p>
      </button>
      <button type="button" data-q3="regularly" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><Calendar class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Pretty Often</h3>
        <p class="text-sm text-slate-600 leading-snug">Multiple times a week, ongoing need</p>
      </button>
      <button type="button" data-q3="try-different" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><Layers class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Want to Experiment</h3>
        <p class="text-sm text-slate-600 leading-snug">See what works best for my body</p>
      </button>
    </div>
  </div>

  <!-- ========== PE FLOW ========== -->
  <!-- Q2: How long has this been an issue? -->
  <div id="question-2-pe" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        How long has this been an issue?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">
        Understanding the pattern helps us find the right solution
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q2-pe="situational" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-amber-600">
          <Clock class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Recently Started / Sometimes</h3>
        <p class="text-sm text-slate-600 leading-snug">Happens with new partners or when stressed</p>
      </button>

      <button type="button" data-q2-pe="chronic" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-red-600">
          <Calendar class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Been Dealing With This for Years</h3>
        <p class="text-sm text-slate-600 leading-snug">Consistent issue, affecting relationship</p>
      </button>

      <button type="button" data-q2-pe="optimize" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-emerald-600">
          <TrendingUp class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Want to Improve Overall</h3>
        <p class="text-sm text-slate-600 leading-snug">Works okay, want it to work better</p>
      </button>
    </div>
  </div>

  <!-- Q3: Situational PE -->
  <div id="question-3-pe-situational" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What would help most?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">
        Performance anxiety has solutions — let's find yours
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3-pe="works-right-away" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600">
          <Zap class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Something That Works Right Away</h3>
        <p class="text-sm text-slate-600 leading-snug">On-demand solution for when I need it</p>
      </button>

      <button type="button" data-q3-pe="no-daily-pills" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-emerald-600">
          <Layers class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Want to Try Without Daily Pills First</h3>
        <p class="text-sm text-slate-600 leading-snug">Prefer topical or as-needed options</p>
      </button>

      <button type="button" data-q3-pe="most-reliable" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600">
          <ShieldCheck class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Whatever Works Most Reliably</h3>
        <p class="text-sm text-slate-600 leading-snug">Effectiveness over convenience</p>
      </button>
    </div>
  </div>

  <!-- Q3: Chronic PE -->
  <div id="question-3-pe-chronic" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's your priority?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">
        Long-term solutions require commitment — what matters most?
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3-pe="consistent-results" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600">
          <Target class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Consistent Results, Even If Daily Pills</h3>
        <p class="text-sm text-slate-600 leading-snug">Need something that works every time</p>
      </button>

      <button type="button" data-q3-pe="medical-guidance" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-indigo-600">
          <Stethoscope class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Medical Guidance on This</h3>
        <p class="text-sm text-slate-600 leading-snug">Want a doctor involved and monitoring</p>
      </button>

      <button type="button" data-q3-pe="combination" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600">
          <Layers class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Try Everything, Combination Approach</h3>
        <p class="text-sm text-slate-600 leading-snug">Maximize effectiveness with all tools</p>
      </button>
    </div>
  </div>

  <!-- Q3: Optimize PE -->
  <div id="question-3-pe-optimize" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What appeals to you?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">
        Optimization mode — let's find what works best
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3-pe="compare-options" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-indigo-600">
          <Layers class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Want to Compare Different Options</h3>
        <p class="text-sm text-slate-600 leading-snug">See all choices, pick what fits</p>
      </button>

      <button type="button" data-q3-pe="combo-approach" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600">
          <Target class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Willing to Try Combo Approach</h3>
        <p class="text-sm text-slate-600 leading-snug">Behavioral techniques + medication</p>
      </button>

      <button type="button" data-q3-pe="simple-affordable" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-emerald-600">
          <CircleDollarSign class="w-10 h-10 sm:w-11 sm:h-11" />
        </div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Keep It Simple and Affordable</h3>
        <p class="text-sm text-slate-600 leading-snug">Cost-effective experimentation</p>
      </button>
    </div>
  </div>

  <!-- ========== HAIR HEALTH FLOW ========== -->
  <div id="question-2-hair-health" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        When did you start noticing it?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Different stages need different approaches — and that's okay</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q2="early" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-green-600"><Sparkles class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Just Starting to See It</h3>
        <p class="text-sm text-slate-600 leading-snug">Hairline's creeping back, want to act now</p>
      </button>
      <button type="button" data-q2="moderate" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-amber-600"><Target class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">It's Pretty Obvious Now</h3>
        <p class="text-sm text-slate-600 leading-snug">Clear pattern, can't hide it anymore</p>
      </button>
      <button type="button" data-q2="advanced" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-red-600"><TrendingDown class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Been Going On a While</h3>
        <p class="text-sm text-slate-600 leading-snug">Significant loss, ready to do something</p>
      </button>
    </div>
  </div>

  <div id="question-3-hair-health-early" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What are you hoping for?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Catching it early gives you options — let's talk real expectations</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="prevention" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><Shield class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Just Stop It From Getting Worse</h3>
        <p class="text-sm text-slate-600 leading-snug">Keep what I have, don't need miracles</p>
      </button>
      <button type="button" data-q3="regrowth" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-green-600"><TrendingUp class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Actually Get Some Back</h3>
        <p class="text-sm text-slate-600 leading-snug">Want to see real regrowth in thin spots</p>
      </button>
    </div>
  </div>

  <div id="question-3-hair-health-moderate" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What matters more right now?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">This is a long game — pick what works for your life</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="affordable" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-emerald-600"><CircleDollarSign class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Can't Break the Bank</h3>
        <p class="text-sm text-slate-600 leading-snug">This'll take months/years — need sustainable pricing</p>
      </button>
      <button type="button" data-q3="medical-guidance" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><BadgeCheck class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Want a Doctor in My Corner</h3>
        <p class="text-sm text-slate-600 leading-snug">Real medical guidance, not just pills</p>
      </button>
    </div>
  </div>

  <div id="question-3-hair-health-advanced" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        Where's your head at?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">At this stage, you need either realistic expectations or aggressive action</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="aggressive" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-red-600"><Zap class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Throw Everything At This</h3>
        <p class="text-sm text-slate-600 leading-snug">Combine treatments, go all-in, maximize results</p>
      </button>
      <button type="button" data-q3="realistic" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><ShieldCheck class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Tell Me What's Actually Possible</h3>
        <p class="text-sm text-slate-600 leading-snug">No BS, just honest expectations</p>
      </button>
    </div>
  </div>

  <!-- ========== TESTOSTERONE FLOW ========== -->
  <div id="question-2-testosterone" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        How much do you know about TRT?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">This is a big commitment — need to know where you're starting from</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q2="new" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-green-600"><UserPlus class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Just Starting to Research</h3>
        <p class="text-sm text-slate-600 leading-snug">Feeling off, wondering if low T is why</p>
      </button>
      <button type="button" data-q2="switching" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><ArrowLeftRight class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">My Clinic Isn't Working Out</h3>
        <p class="text-sm text-slate-600 leading-snug">On TRT but want different provider</p>
      </button>
      <button type="button" data-q2="optimizing" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><TrendingUp class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Want to Fine-Tune My Protocol</h3>
        <p class="text-sm text-slate-600 leading-snug">It's working, but could be better</p>
      </button>
    </div>
  </div>

  <div id="question-3-testosterone-new" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What matters most to you?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your top priority</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="comprehensive-testing" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><Microscope class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Comprehensive Testing</h3>
        <p class="text-sm text-slate-600 leading-snug">Detailed labs and monitoring</p>
      </button>
      <button type="button" data-q3="affordable-trt" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-emerald-600"><CircleDollarSign class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Affordability</h3>
        <p class="text-sm text-slate-600 leading-snug">Budget-friendly TRT option</p>
      </button>
      <button type="button" data-q3="medical-oversight" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-purple-600"><ShieldCheck class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Medical Oversight</h3>
        <p class="text-sm text-slate-600 leading-snug">Expert physician supervision</p>
      </button>
      <button type="button" data-q3="easy-trt" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-amber-600"><Zap class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Easy Process</h3>
        <p class="text-sm text-slate-600 leading-snug">Simple, convenient experience</p>
      </button>
    </div>
  </div>

  <div id="question-3-testosterone-switching" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's driving your switch?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Help us find a better fit</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="cost-concerns" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-red-600"><TrendingDown class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Cost Concerns</h3>
        <p class="text-sm text-slate-600 leading-snug">Current provider too expensive</p>
      </button>
      <button type="button" data-q3="better-testing" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><TestTube class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Better Testing</h3>
        <p class="text-sm text-slate-600 leading-snug">Want more comprehensive labs</p>
      </button>
      <button type="button" data-q3="more-support" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-purple-600"><Headphones class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">More Support</h3>
        <p class="text-sm text-slate-600 leading-snug">Need better guidance and care</p>
      </button>
      <button type="button" data-q3="convenience" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-amber-600"><Clock class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Convenience</h3>
        <p class="text-sm text-slate-600 leading-snug">Current process too complicated</p>
      </button>
    </div>
  </div>

  <div id="question-3-testosterone-optimizing" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What would make your TRT better?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your improvement goal</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3="lower-cost" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-emerald-600"><CircleDollarSign class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Lower Cost</h3>
        <p class="text-sm text-slate-600 leading-snug">Reduce monthly expense</p>
      </button>
      <button type="button" data-q3="detailed-labs" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><BarChart class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Detailed Labs</h3>
        <p class="text-sm text-slate-600 leading-snug">More comprehensive testing</p>
      </button>
      <button type="button" data-q3="better-convenience" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-amber-600"><Zap class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Better Convenience</h3>
        <p class="text-sm text-slate-600 leading-snug">Simpler, easier process</p>
      </button>
    </div>
  </div>

  <!-- ========== WEIGHT LOSS FLOW ========== -->
  <div id="question-2-weight-loss" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What are you trying to lose?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Pick the range that feels right — no judgment, just matching you to the right support</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q2="modest" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-green-600"><Target class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">10-25 lbs</h3>
        <p class="text-sm text-slate-600 leading-snug">Get back to where I was a year ago</p>
      </button>
      <button type="button" data-q2="significant" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><TrendingDown class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">25-50 lbs</h3>
        <p class="text-sm text-slate-600 leading-snug">This has been creeping up for a while</p>
      </button>
      <button type="button" data-q2="major" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><Activity class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">50+ lbs</h3>
        <p class="text-sm text-slate-600 leading-snug">Ready for real change, need real help</p>
      </button>
    </div>
  </div>

  <div id="question-3-weight-loss-modest" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What type of support do you want?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your approach</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="medication-only" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><Pill class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Medication Only</h3>
        <p class="text-sm text-slate-600 leading-snug">Just the prescription, no extras</p>
      </button>
      <button type="button" data-q3="holistic" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-green-600"><Heart class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Holistic Program</h3>
        <p class="text-sm text-slate-600 leading-snug">Medication + lifestyle support</p>
      </button>
    </div>
  </div>

  <div id="question-3-weight-loss-significant" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's your priority?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose what matters most</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="affordable-weight" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-emerald-600"><CircleDollarSign class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Affordability</h3>
        <p class="text-sm text-slate-600 leading-snug">Most budget-friendly option</p>
      </button>
      <button type="button" data-q3="supervised" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><BadgeCheck class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Medical Supervision</h3>
        <p class="text-sm text-slate-600 leading-snug">Expert oversight and monitoring</p>
      </button>
    </div>
  </div>

  <div id="question-3-weight-loss-major" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What do you need for success?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your support level</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="comprehensive-care" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-purple-600"><Package class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Comprehensive Care</h3>
        <p class="text-sm text-slate-600 leading-snug">Full support system, all tools</p>
      </button>
      <button type="button" data-q3="flexibility" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><Layers class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Flexibility & Options</h3>
        <p class="text-sm text-slate-600 leading-snug">Multiple medication choices</p>
      </button>
    </div>
  </div>

  <!-- ========== MENTAL HEALTH FLOW ========== -->
  <div id="question-2-mental-health" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What feels right for where you're at?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Getting help is the hardest part — choosing how is easier than you think</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q2="therapy" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><Users class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Need Someone to Talk To</h3>
        <p class="text-sm text-slate-600 leading-snug">Therapy/counseling sessions</p>
      </button>
      <button type="button" data-q2="medication" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><Pill class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Think I Need Medication</h3>
        <p class="text-sm text-slate-600 leading-snug">Psychiatric care and prescriptions</p>
      </button>
      <button type="button" data-q2="both" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-green-600"><Heart class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Want Both if Possible</h3>
        <p class="text-sm text-slate-600 leading-snug">Therapy + medication working together</p>
      </button>
    </div>
  </div>

  <div id="question-3-mental-health-therapy" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What matters most in a therapist?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your priority</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="broad-network" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><Users class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Broad Therapist Network</h3>
        <p class="text-sm text-slate-600 leading-snug">More therapists to choose from</p>
      </button>
      <button type="button" data-q3="specialized-matching" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-purple-600"><Target class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Specialized Matching</h3>
        <p class="text-sm text-slate-600 leading-snug">Carefully matched to your needs</p>
      </button>
    </div>
  </div>

  <div id="question-3-mental-health-medication" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's your priority?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose what matters most</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="fast-access" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><Clock class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Fast Access</h3>
        <p class="text-sm text-slate-600 leading-snug">Quick consultation and prescription</p>
      </button>
      <button type="button" data-q3="ongoing-relationship" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-purple-600"><Heart class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Ongoing Relationship</h3>
        <p class="text-sm text-slate-600 leading-snug">Long-term physician partnership</p>
      </button>
    </div>
  </div>

  <div id="question-3-mental-health-both" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What do you need from your provider?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your approach</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="integrated" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-purple-600"><Package class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Integrated Care</h3>
        <p class="text-sm text-slate-600 leading-snug">Coordinated therapy and medication</p>
      </button>
      <button type="button" data-q3="flexible" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><Layers class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Flexibility to Choose</h3>
        <p class="text-sm text-slate-600 leading-snug">Pick separate providers if needed</p>
      </button>
    </div>
  </div>

  <!-- ========== DIAGNOSTICS FLOW ========== -->
  <div id="question-2-diagnostics" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What tests are you interested in?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your testing needs</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q2="hormone" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><Activity class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Hormone Panel</h3>
        <p class="text-sm text-slate-600 leading-snug">Testosterone, thyroid tests</p>
      </button>
      <button type="button" data-q2="sexual" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><Heart class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Sexual Health</h3>
        <p class="text-sm text-slate-600 leading-snug">STD/STI screening</p>
      </button>
      <button type="button" data-q2="comprehensive" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-green-600"><TestTube class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Comprehensive</h3>
        <p class="text-sm text-slate-600 leading-snug">Full health panel</p>
      </button>
    </div>
  </div>

  <div id="question-3-diagnostics" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's your priority?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose what matters most</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="fast-results" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><Clock class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Fast Results</h3>
        <p class="text-sm text-slate-600 leading-snug">Quick turnaround time</p>
      </button>
      <button type="button" data-q3="detailed-analysis" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-purple-600"><FileText class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Detailed Analysis</h3>
        <p class="text-sm text-slate-600 leading-snug">Comprehensive interpretation</p>
      </button>
      <button type="button" data-q3="consultation" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-green-600"><Users class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Doctor Consultation</h3>
        <p class="text-sm text-slate-600 leading-snug">Physician review included</p>
      </button>
      <button type="button" data-q3="affordable-test" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-emerald-600"><CircleDollarSign class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Most Affordable</h3>
        <p class="text-sm text-slate-600 leading-snug">Budget-friendly testing</p>
      </button>
    </div>
  </div>

  <!-- ========== SLEEP FLOW ========== -->
  <div id="question-2-sleep" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's behind the sleepless nights?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">
        Different causes need different solutions — let's figure out what's going on
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q2="stress" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-orange-600"><Activity class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Work Stress Is Killing My Sleep</h3>
        <p class="text-sm text-slate-600 leading-snug">Brain won't shut off, thinking about deadlines</p>
      </button>
      <button type="button" data-q2="chronic" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-red-600"><Calendar class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">I've Been Fighting This for Years</h3>
        <p class="text-sm text-slate-600 leading-snug">Tried everything, nothing sticks</p>
      </button>
      <button type="button" data-q2="acute" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><TrendingUp class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Life Just Got Crazy</h3>
        <p class="text-sm text-slate-600 leading-snug">Big changes, temporary chaos</p>
      </button>
    </div>
  </div>

  <div id="question-3-sleep-stress" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What matters most right now?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Pick your top priority</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3="no-hangover" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-green-600"><Zap class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Won't Mess Up My Morning</h3>
        <p class="text-sm text-slate-600 leading-snug">Need to be sharp for work tomorrow</p>
      </button>
      <button type="button" data-q3="non-addictive" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><ShieldCheck class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Not Becoming Dependent</h3>
        <p class="text-sm text-slate-600 leading-snug">Want something non-habit forming</p>
      </button>
      <button type="button" data-q3="fast-sleep" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><Clock class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Need It Fast, Life Can't Wait</h3>
        <p class="text-sm text-slate-600 leading-snug">Immediate relief, quick delivery</p>
      </button>
    </div>
  </div>

  <div id="question-3-sleep-chronic" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What do you need to finally fix this?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your priority</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3="medical-oversight-sleep" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><BadgeCheck class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Real Medical Oversight</h3>
        <p class="text-sm text-slate-600 leading-snug">Proper diagnosis and monitoring</p>
      </button>
      <button type="button" data-q3="affordable-longterm" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-emerald-600"><CircleDollarSign class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Something I Can Afford Long-Term</h3>
        <p class="text-sm text-slate-600 leading-snug">Sustainable cost for ongoing use</p>
      </button>
      <button type="button" data-q3="try-new-sleep" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><RefreshCw class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Honestly, I Need to Try Something New</h3>
        <p class="text-sm text-slate-600 leading-snug">Willing to experiment with guidance</p>
      </button>
    </div>
  </div>

  <div id="question-3-sleep-acute" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        How do you want to handle this?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your approach</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3="temporary-sleep" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><Clock class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Get Me Through This, Then I'm Done</h3>
        <p class="text-sm text-slate-600 leading-snug">Temporary use, no long-term commitment</p>
      </button>
      <button type="button" data-q3="private-sleep" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><Lock class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Keep It Totally Private</h3>
        <p class="text-sm text-slate-600 leading-snug">Maximum discretion and privacy</p>
      </button>
      <button type="button" data-q3="simple-sleep" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-green-600"><Zap class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Just Make It Simple</h3>
        <p class="text-sm text-slate-600 leading-snug">Easy process, no complications</p>
      </button>
    </div>
  </div>

  <!-- ========== HERPES FLOW ========== -->
  <div id="question-2-herpes" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        Where are you with herpes?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">
        Everyone's situation is different — let's find what fits yours
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q2="new-diagnosis" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><FileText class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Just Got Diagnosed</h3>
        <p class="text-sm text-slate-600 leading-snug">Still processing this, need to understand it</p>
      </button>
      <button type="button" data-q2="frequent" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-red-600"><RefreshCw class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Outbreaks Won't Stop</h3>
        <p class="text-sm text-slate-600 leading-snug">Having them way too often, need better control</p>
      </button>
      <button type="button" data-q2="relationship" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><Heart class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Protecting My Partner</h3>
        <p class="text-sm text-slate-600 leading-snug">In a relationship, want to minimize their risk</p>
      </button>
    </div>
  </div>

  <div id="question-3-herpes-new-diagnosis" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What do you need most right now?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your priority</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3="understand-herpes" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><FileText class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Help Me Understand This</h3>
        <p class="text-sm text-slate-600 leading-snug">Education and context</p>
      </button>
      <button type="button" data-q3="max-discretion" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><Lock class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Maximum Discretion</h3>
        <p class="text-sm text-slate-600 leading-snug">Privacy and stigma concerns</p>
      </button>
      <button type="button" data-q3="manage-outbreak" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-red-600"><Zap class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Manage This First Outbreak</h3>
        <p class="text-sm text-slate-600 leading-snug">Immediate symptom relief</p>
      </button>
    </div>
  </div>

  <div id="question-3-herpes-frequent" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's your priority?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose what matters most</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3="stop-outbreaks" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-green-600"><ShieldCheck class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Stop Them From Happening</h3>
        <p class="text-sm text-slate-600 leading-snug">Suppressive therapy effectiveness</p>
      </button>
      <button type="button" data-q3="affordable-herpes" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-emerald-600"><CircleDollarSign class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Make It Affordable</h3>
        <p class="text-sm text-slate-600 leading-snug">Cost of daily medication</p>
      </button>
      <button type="button" data-q3="medical-guidance-herpes" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><BadgeCheck class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Get Real Medical Guidance</h3>
        <p class="text-sm text-slate-600 leading-snug">Want doctor monitoring</p>
      </button>
    </div>
  </div>

  <div id="question-3-herpes-relationship" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What matters most?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your priority</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3="reduce-transmission" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><Shield class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Reduce Transmission Risk</h3>
        <p class="text-sm text-slate-600 leading-snug">Partner safety first</p>
      </button>
      <button type="button" data-q3="expert-advice" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><Users class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Get Expert Advice</h3>
        <p class="text-sm text-slate-600 leading-snug">Medical guidance on risk management</p>
      </button>
      <button type="button" data-q3="all-tools" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-green-600"><Package class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">All the Tools I Can Get</h3>
        <p class="text-sm text-slate-600 leading-snug">Comprehensive approach</p>
      </button>
    </div>
  </div>

  <!-- ========== PEPTIDES FLOW ========== -->
  <div id="question-2-peptides" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What path makes sense for you?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">
        Peptides can be obtained through medical clinics, research suppliers, or education first
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q2="medical" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><BadgeCheck class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Medical Supervision</h3>
        <p class="text-sm text-slate-600 leading-snug">Doctor-prescribed, blood work included</p>
      </button>
      <button type="button" data-q2="research" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-orange-600"><Microscope class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Research Suppliers</h3>
        <p class="text-sm text-slate-600 leading-snug">DIY approach, you manage everything</p>
      </button>
      <button type="button" data-q2="education" class="q2-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><FileText class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Learn First</h3>
        <p class="text-sm text-slate-600 leading-snug">Education and training courses</p>
      </button>
    </div>
  </div>

  <div id="question-3-peptides-medical" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's your focus?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your optimization goal</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="peptides-only" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><Zap class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Peptides Specifically</h3>
        <p class="text-sm text-slate-600 leading-snug">Focused peptide therapy programs</p>
      </button>
      <button type="button" data-q3="comprehensive-peptides" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-purple-600"><Package class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Full Optimization</h3>
        <p class="text-sm text-slate-600 leading-snug">Peptides + TRT + weight loss options</p>
      </button>
    </div>
  </div>

  <div id="question-3-peptides-research" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's your priority?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose what matters most</p>
    </div>
    <div class="grid md:grid-cols-3 gap-3 sm:gap-4 lg:gap-5 max-w-3xl mx-auto">
      <button type="button" data-q3="budget-peptides" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-emerald-600"><CircleDollarSign class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Most Affordable</h3>
        <p class="text-sm text-slate-600 leading-snug">Budget US supplier</p>
      </button>
      <button type="button" data-q3="international-peptides" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-blue-600"><Activity class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">International Options</h3>
        <p class="text-sm text-slate-600 leading-snug">Canada or EU-based suppliers</p>
      </button>
      <button type="button" data-q3="premium-peptides" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-center cursor-pointer transition-all duration-200 focus-ring group min-h-[160px] flex flex-col items-center justify-center">
        <div class="flex justify-center mb-3 text-purple-600"><Sparkles class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Premium Products</h3>
        <p class="text-sm text-slate-600 leading-snug">Peptides + nootropics/supplements</p>
      </button>
    </div>
  </div>

  <div id="question-3-peptides-education" class="question-step hidden">
    <div class="text-center mb-8 sm:mb-10">
      <button type="button" class="back-btn text-sm text-slate-500 hover:text-slate-700 mb-4 inline-flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </button>
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
        What's your goal?
      </h2>
      <p class="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto px-4">Choose your learning path</p>
    </div>
    <div class="grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-5 max-w-2xl mx-auto">
      <button type="button" data-q3="learn-first" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-blue-600"><FileText class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Consumer Education</h3>
        <p class="text-sm text-slate-600 leading-snug">Learn before deciding on treatment</p>
      </button>
      <button type="button" data-q3="practitioner" class="q3-card card-hover p-4 sm:p-5 lg:p-6 text-left cursor-pointer transition-all duration-200 focus-ring group min-h-[140px] flex flex-col">
        <div class="flex mb-3 text-purple-600"><BadgeCheck class="w-10 h-10 sm:w-11 sm:h-11" /></div>
        <h3 class="font-heading font-bold text-base sm:text-lg text-slate-900 mb-2 group-hover:text-brand-accent transition-colors">Practitioner Certification</h3>
        <p class="text-sm text-slate-600 leading-snug">Professional training and credentials</p>
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div id="loading-state" class="hidden text-center py-12">
    <svg class="animate-spin h-12 w-12 mx-auto mb-4 text-brand-accent" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
    </svg>
    <h3 class="text-xl font-semibold text-slate-900 mb-2">Finding Your Perfect Match...</h3>
    <p class="text-slate-600">Analyzing your answers and comparing services</p>
  </div>
</div>

<style>
  .question-step {
    display: none;
  }

  .question-step.active {
    display: block;
  }

  .category-card:hover,
  .q2-card:hover,
  .q3-card:hover {
    transform: translateY(-2px);
  }
</style>

<script>
  interface UserChoices {
    category?: string;
    sexualHealthType?: string; // 'ed', 'pe', or 'both'
    q2?: string;
    q2pe?: string; // For PE-specific Q2 choices
    q3?: string;
    q3pe?: string; // For PE-specific Q3 choices
  }

  function initGuidedMatcher() {
    const userChoices: UserChoices = {};
    let currentStep = 1;

    function updateProgress(step: number) {
      currentStep = step;
      const percent = Math.round((step / 3) * 100);

      const progressBar = document.getElementById('progress-bar');
      const progressCurrent = document.getElementById('progress-current');
      const progressPercent = document.getElementById('progress-percent');

      if (progressBar) progressBar.style.width = `${percent}%`;
      if (progressCurrent) progressCurrent.textContent = String(step);
      if (progressPercent) progressPercent.textContent = String(percent);
    }

    function showStep(stepId: string) {
      document.querySelectorAll('.question-step').forEach(step => {
        step.classList.remove('active');
      });

      const targetStep = document.getElementById(stepId);
      if (targetStep) {
        targetStep.classList.add('active');

        // Scroll the question into view with smooth animation
        // Use 'center' to give breathing room above the question
        setTimeout(() => {
          targetStep.scrollIntoView({
            behavior: 'smooth',
            block: 'center',
            inline: 'nearest'
          });
        }, 100);
      }
    }

    // Q1: Category Selection
    document.querySelectorAll('.category-card').forEach(card => {
      card.addEventListener('click', () => {
        const category = card.getAttribute('data-category');
        if (!category) return;

        userChoices.category = category;

        // For sexual-health, go to Q1.5 to differentiate ED/PE/Both
        if (category === 'sexual-health') {
          updateProgress(2);
          showStep('question-1-5-sexual-health');
        } else {
          updateProgress(2);
          showStep(`question-2-${category}`);
        }

        if (typeof window !== 'undefined' && (window as any).gtag) {
          (window as any).gtag('event', 'guide_category_selected', { category });
        }
      });
    });

    // Q1.5: Sexual Health Type Selection (ED vs PE vs Both)
    document.querySelectorAll('.sexual-health-type-card').forEach(card => {
      card.addEventListener('click', () => {
        const type = card.getAttribute('data-sexual-health-type');
        if (!type) return;

        userChoices.sexualHealthType = type;
        updateProgress(2);

        // Route to appropriate Q2 based on type
        if (type === 'pe') {
          showStep('question-2-pe');
        } else if (type === 'ed') {
          showStep('question-2-sexual-health-ed');
        } else if (type === 'both') {
          // For 'both', use the ED flow for now (could create a dedicated flow later)
          showStep('question-2-sexual-health-ed');
        }

        if (typeof window !== 'undefined' && (window as any).gtag) {
          (window as any).gtag('event', 'sexual_health_type_selected', { type });
        }
      });
    });

    // Q2: All categories
    document.querySelectorAll('.q2-card').forEach(card => {
      card.addEventListener('click', () => {
        const q2 = card.getAttribute('data-q2');
        if (!q2 || !userChoices.category) return;

        userChoices.q2 = q2;
        updateProgress(3);
        showStep(`question-3-${userChoices.category}-${q2}`);

        if (typeof window !== 'undefined' && (window as any).gtag) {
          (window as any).gtag('event', 'guide_q2_selected', { category: userChoices.category, q2 });
        }
      });
    });

    // Q3: All categories
    document.querySelectorAll('.q3-card').forEach(card => {
      card.addEventListener('click', () => {
        const q3 = card.getAttribute('data-q3');
        if (!q3) return;

        userChoices.q3 = q3;
        showResults();

        if (typeof window !== 'undefined' && (window as any).gtag) {
          (window as any).gtag('event', 'guide_q3_selected', {
            category: userChoices.category,
            q2: userChoices.q2,
            q3
          });
        }
      });
    });

    // Q2-PE: PE-specific Q2 options
    document.querySelectorAll('[data-q2-pe]').forEach(card => {
      card.addEventListener('click', () => {
        const q2pe = card.getAttribute('data-q2-pe');
        if (!q2pe) return;

        userChoices.q2pe = q2pe;
        updateProgress(3);
        showStep(`question-3-pe-${q2pe}`);

        if (typeof window !== 'undefined' && (window as any).gtag) {
          (window as any).gtag('event', 'guide_q2_pe_selected', { q2pe });
        }
      });
    });

    // Q3-PE: PE-specific Q3 options
    document.querySelectorAll('[data-q3-pe]').forEach(card => {
      card.addEventListener('click', () => {
        const q3pe = card.getAttribute('data-q3-pe');
        if (!q3pe) return;

        userChoices.q3pe = q3pe;
        showResults();

        if (typeof window !== 'undefined' && (window as any).gtag) {
          (window as any).gtag('event', 'guide_q3_pe_selected', {
            q2pe: userChoices.q2pe,
            q3pe
          });
        }
      });
    });

    // Back button handling
    document.querySelectorAll('.back-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const currentQuestion = document.querySelector('.question-step.active');
        if (!currentQuestion) return;

        const currentId = currentQuestion.id;

        // Handle PE Q3 flows
        if (currentId.startsWith('question-3-pe-')) {
          showStep('question-2-pe');
          updateProgress(2);
          delete userChoices.q3pe;
        }
        // Handle regular Q3 flows
        else if (currentId.startsWith('question-3')) {
          // For ED flow, go back to question-2-sexual-health-ed
          if (userChoices.category === 'sexual-health' && userChoices.sexualHealthType === 'ed') {
            showStep('question-2-sexual-health-ed');
          } else {
            showStep(`question-2-${userChoices.category}`);
          }
          updateProgress(2);
          delete userChoices.q3;
        }
        // Handle PE Q2
        else if (currentId === 'question-2-pe') {
          showStep('question-1-5-sexual-health');
          updateProgress(2);
          delete userChoices.q2pe;
        }
        // Handle ED Q2
        else if (currentId === 'question-2-sexual-health-ed') {
          showStep('question-1-5-sexual-health');
          updateProgress(2);
          delete userChoices.q2;
        }
        // Handle Q1.5 (sexual health type selection)
        else if (currentId === 'question-1-5-sexual-health') {
          showStep('question-1');
          updateProgress(1);
          delete userChoices.sexualHealthType;
        }
        // Handle regular Q2 flows
        else if (currentId.startsWith('question-2')) {
          showStep('question-1');
          updateProgress(1);
          delete userChoices.q2;
          delete userChoices.q3;
        }
      });
    });

    function showResults() {
      document.querySelectorAll('.question-step').forEach(step => {
        step.classList.remove('active');
      });

      const loadingState = document.getElementById('loading-state');
      if (loadingState) {
        loadingState.classList.remove('hidden');
      }

      sessionStorage.setItem('guidedChoices', JSON.stringify(userChoices));

      setTimeout(() => {
        window.dispatchEvent(new CustomEvent('guided-complete', {
          detail: userChoices
        }));
      }, 1500);
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initGuidedMatcher);
  } else {
    initGuidedMatcher();
  }

  document.addEventListener('astro:page-load', initGuidedMatcher);
</script>
