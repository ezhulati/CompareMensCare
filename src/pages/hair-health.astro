---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import FilterableComparison from '../components/FilterableComparison.astro';
import QuickPicks from '../components/QuickPicks.astro';
import TrustSignals from '../components/TrustSignals.astro';
import FAQSection from '../components/FAQSection.astro';
import Icon from '../components/Icon.astro';
import type { FilterableBrand } from '../components/FilterableComparison.astro';

// Get all brands that offer hair health services
const allBrands = await getCollection('brands');
const hairHealthBrands = allBrands
  .filter((brand) => brand.data.categories.includes('hair-health'))
  .map((brand): FilterableBrand => ({
    name: brand.data.title,
    slug: brand.slug,
    rating: brand.data.rating,
    consultationFee: brand.data.pricing.consultationFee,
    medicationFrom: brand.data.pricing.medicationFrom || brand.data.pricing.consultationFee,
    subscriptionType: brand.data.pricing.subscriptionType,
    pros: brand.data.pros,
    cons: brand.data.cons,
    bestFor: brand.data.bestFor,
    featured: brand.data.featured,
    features: brand.data.features,
    priorities: brand.data.priorities,
    priceMin: brand.data.pricing.priceMin,
    priceMax: brand.data.pricing.priceMax,
  }));

// Quick picks for this category
const quickPicks = [
  {
    segment: 'budget' as const,
    brandName: 'Keeps',
    brandSlug: 'keeps',
    detail: '$7/month, 50% off first order',
  },
  {
    segment: 'privacy' as const,
    brandName: 'Hims',
    brandSlug: 'hims',
    detail: 'Discreet delivery, auto-refill',
  },
  {
    segment: 'speed' as const,
    brandName: 'Hims',
    brandSlug: 'hims',
    detail: 'Fast approval, 2-day shipping',
  },
  {
    segment: 'quality' as const,
    brandName: 'Ro',
    brandSlug: 'ro',
    detail: 'Brand & generic, MD consultation',
  },
];

const schema = {
  '@context': 'https://schema.org',
  '@type': 'MedicalWebPage',
  name: 'Best Hair Loss Treatment Services for Men',
  description: 'Compare the best online hair loss treatment services including Keeps, Hims, and Ro for finasteride and minoxidil.',
};

// FAQ data for AI-SEO optimization
const faqs = [
  {
    question: "How much does online hair loss treatment cost?",
    answer: "Online hair loss treatment costs $15-40 per month for finasteride, $10-30 per month for minoxidil, and $25-50 per month for combination treatments. Most services charge $0-49 for the initial consultation. Keeps offers the lowest prices starting at $7/month with first-order discounts, while Hims and Ro average $20-40/month depending on the treatment plan."
  },
  {
    question: "Does finasteride really work for hair loss?",
    answer: "Yes, finasteride is clinically proven to work for 80-90% of men with male pattern baldness. Studies show finasteride stops hair loss in 83% of men and promotes regrowth in 66% of users after 2 years of treatment. It works by blocking DHT, the hormone responsible for hair follicle miniaturization. Results typically become visible after 3-6 months of consistent daily use."
  },
  {
    question: "What's the difference between finasteride and minoxidil?",
    answer: "Finasteride is an oral medication (pill) that blocks DHT hormone production internally, while minoxidil is a topical solution applied directly to the scalp. Finasteride is 80-90% effective at stopping hair loss and requires a prescription. Minoxidil is 60-70% effective at promoting regrowth and is available over-the-counter. Many users combine both for maximum effectiveness."
  },
  {
    question: "How long before I see hair growth results?",
    answer: "Most users see results in 3-12 months. Hair loss typically slows or stops within 2-4 months of starting treatment. Visible regrowth usually appears around 6-12 months with consistent use. Maximum results occur at 1-2 years. Progress varies by individual - some see changes at 3 months, others need 12+ months. Consistency is critical for success."
  },
  {
    question: "Are there side effects from finasteride or minoxidil?",
    answer: "Finasteride side effects are rare but include decreased libido (2-4% of users), erectile dysfunction (1-3%), and reduced ejaculate volume (1-2%). Most side effects resolve after stopping treatment. Minoxidil can cause scalp irritation, dryness, or unwanted facial hair growth if solution drips. The vast majority of users (85-90%) experience no significant side effects from either medication."
  },
  {
    question: "Do I need to use hair loss medication forever?",
    answer: "Yes, hair loss medications require ongoing use to maintain results. If you stop finasteride or minoxidil, hair loss will resume within 6-12 months and you'll lose any regrowth achieved. Think of it like managing a chronic condition - continuous treatment is necessary. Most online services offer affordable subscription plans ($15-40/month) to make long-term treatment sustainable."
  },
  {
    question: "Is generic finasteride as effective as brand-name Propecia?",
    answer: "Yes, generic finasteride is identical to brand-name Propecia in effectiveness. Both contain the same active ingredient (1mg finasteride) and are FDA-approved as bioequivalent. The only difference is price - generic finasteride costs $15-25/month while Propecia costs $70-90/month. All major online services (Hims, Keeps, Ro) offer generic finasteride."
  },
  {
    question: "Can I get hair loss treatment without seeing a doctor in person?",
    answer: "Yes, online hair loss services provide legitimate medical treatment without in-person visits. You complete a medical questionnaire online, a licensed physician reviews it and prescribes treatment if appropriate, then medications ship directly to you. This is legal telehealth, not a workaround - services like Hims, Keeps, and Ro use board-certified doctors and FDA-approved medications."
  },
  {
    question: "Which is better: Hims, Keeps, or Ro for hair loss?",
    answer: "Keeps offers the best value at $7-25/month with frequent discounts. Hims offers the most convenience with a one-stop platform for multiple health needs at $20-40/month. Ro provides the most flexibility with pay-per-dose options and ongoing physician support at $25-45/month. Your best choice depends on whether you prioritize price (Keeps), convenience (Hims), or flexibility (Ro)."
  },
  {
    question: "Will minoxidil foam or solution work better?",
    answer: "Minoxidil foam and solution have similar effectiveness (both ~60-70% success rate). Foam is less messy, dries faster, and causes less scalp irritation, but costs slightly more. Solution is more affordable and may penetrate better but can cause more dryness. Most users prefer foam for convenience despite the $5-10/month higher cost. Both require twice-daily application for best results."
  }
];
---

<BaseLayout
  title="Best Hair Loss Treatment Services - Compare Finasteride & Minoxidil"
  description="Compare the top hair loss treatment services for men. Find the best prices on finasteride, minoxidil, and combination treatments from Keeps, Hims, Ro, and more."
  image="/images/hair-health-og.png"
  schema={schema}
>
  <!-- Hero Section -->
  <section class="bg-white py-12 lg:py-16 border-b border-slate-200">
    <div class="container-custom">
      <div class="max-w-4xl">
        <div class="flex items-center gap-2 text-sm text-slate-600 mb-6">
          <a href="/" class="hover:text-brand-accent transition-colors">Home</a>
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
          <span class="text-slate-900 font-medium">Hair Health</span>

        <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-emerald-50 border border-emerald-200 text-sm font-medium text-emerald-700 mb-6">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          New to telehealth? We'll walk you through it
        </div>
        </div>

        <h1 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-slate-900 mb-4 sm:mb-6 leading-tight px-4">
          Get Your Hair Back
        </h1>
        <p class="text-base sm:text-lg lg:text-xl text-slate-600 leading-relaxed mb-6 sm:mb-8 max-w-2xl px-4">
          Stop watching it thin. Start seeing regrowth. Real treatments proven to stop hair loss and regrow what you've lost — from $7/month. Compare services with honest pricing and real results.
        </p>

        <div class="flex flex-wrap gap-3">
          <a href="#comparison" class="btn-primary">
            Find My Treatment
          </a>
          <a href="#faq" class="btn-outline">
            How It Works
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Quick Stats -->
  <section class="py-10 bg-slate-50 border-b border-slate-200">
    <div class="container-custom">
      <div class="grid grid-cols-2 lg:grid-cols-4 gap-6 lg:gap-8 text-center">
        <div>
          <div class="text-xl sm:text-2xl lg:text-3xl font-bold text-slate-900 mb-1">{hairHealthBrands.length}</div>
          <div class="text-sm text-slate-600">Services Compared</div>
        </div>
        <div>
          <div class="text-xl sm:text-2xl lg:text-3xl font-bold text-slate-900 mb-1">$7+</div>
          <div class="text-sm text-slate-600">Starting Price</div>
        </div>
        <div>
          <div class="text-xl sm:text-2xl lg:text-3xl font-bold text-slate-900 mb-1">FDA</div>
          <div class="text-sm text-slate-600">Approved</div>
        </div>
        <div>
          <div class="text-xl sm:text-2xl lg:text-3xl font-bold text-slate-900 mb-1">3-6mo</div>
          <div class="text-sm text-slate-600">See Results</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Quick Picks Section -->
  <section class="section bg-white">
    <div class="container-custom">
      <QuickPicks picks={quickPicks} category="Hair Health" />
    </div>
  </section>

  <!-- Trust Signals -->
  <section class="py-6 bg-white">
    <div class="container-custom">
      <TrustSignals
        lastUpdated={new Date()}
        reviewsCount={12000}
        servicesCompared={hairHealthBrands.length}
      />
    </div>
  </section>

  <!-- Comparison Section -->
  <section id="comparison" class="section bg-white">
    <div class="container-custom">
      <div class="mb-10">
        <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-2 sm:mb-3 px-4">
          Find Your Treatment
        </h2>
        <p class="text-slate-600">
          Updated {new Date().toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}
        </p>
      </div>

      <FilterableComparison brands={hairHealthBrands} location="hair-health-table" />
    </div>
  </section>

  <!-- Treatment Options -->
  <section id="treatments" class="section-light">
    <div class="container-custom">
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900 mb-3 sm:mb-4 text-center px-4">
        What Actually Regrows Hair
      </h2>
      <p class="text-lg text-slate-600 mb-10 text-center max-w-2xl mx-auto">
        Two FDA-approved medications proven to stop loss and regrow what you've lost.
      </p>

      <div class="grid md:grid-cols-2 gap-6 max-w-4xl mx-auto">
        <div class="card p-6">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-12 h-12 rounded-xl bg-blue-100 text-blue-600 flex items-center justify-center">
              <Icon name="pill" class="w-6 h-6" />
            </div>
            <h3 class="font-bold text-xl text-slate-900">Finasteride</h3>
          </div>
          <p class="text-sm text-slate-500 mb-2">Oral Medication (Propecia)</p>
          <p class="text-slate-600 text-sm mb-4 leading-relaxed">
            Blocks DHT, the hormone that causes male pattern baldness. Take daily. 80-90% of users maintain or regrow hair. Most effective treatment available.
          </p>
          <div class="text-sm">
            <div class="font-medium text-slate-900 mb-2">Pricing:</div>
            <ul class="space-y-1 text-slate-600">
              <li>• Keeps: $7-20/month</li>
              <li>• Hims: $25-40/month</li>
              <li>• Ro: $30-50/month</li>
            </ul>
          </div>
        </div>

        <div class="card p-6 ring-2 ring-brand-accent">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-12 h-12 rounded-xl bg-emerald-100 text-emerald-600 flex items-center justify-center">
              <Icon name="lotion" class="w-6 h-6" />
            </div>
            <h3 class="font-bold text-xl text-slate-900">Minoxidil</h3>
          </div>
          <p class="text-sm text-slate-500 mb-2">Topical Solution (Rogaine)</p>
          <p class="text-slate-600 text-sm mb-4 leading-relaxed">
            Stimulates blood flow to hair follicles. Apply twice daily. Works best for crown/top of head. Often combined with finasteride for best results.
          </p>
          <div class="text-sm">
            <div class="font-medium text-slate-900 mb-2">Pricing:</div>
            <ul class="space-y-1 text-slate-600">
              <li>• Keeps: $15-25/month</li>
              <li>• Hims: $15-30/month</li>
              <li>• Ro: $20-35/month</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="text-center mt-8">
        <div class="inline-flex items-center gap-2 px-4 py-2 bg-white rounded-xl border border-slate-200">
          <svg class="w-5 h-5 text-emerald-600" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
          </svg>
          <span class="text-sm font-medium text-slate-700">
            Combination therapy (finasteride + minoxidil) provides best results
          </span>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ Section with Schema Markup -->
  <section id="faq" class="section bg-white">
    <div class="container-custom max-w-3xl">
      <FAQSection
        title="Common Questions About Hair Loss Treatment"
        categoryName="Hair Loss & Male Pattern Baldness"
        faqs={faqs}
      />
    </div>
  </section>

  <!-- Related Content -->
  <section class="section-light border-t border-slate-200">
    <div class="container-custom">
      <h2 class="text-2xl font-bold text-slate-900 mb-6 text-center">
        Explore More Categories
      </h2>
      <div class="grid md:grid-cols-3 gap-6">
        <a href="/sexual-health" class="card-hover p-6 group">
          <div class="mb-3 flex justify-center">
            <Icon name="sexual-health" class="w-8 h-8 text-red-600" />
          </div>
          <h3 class="font-semibold text-lg mb-2 text-slate-900 group-hover:text-brand-accent transition-colors">
            Sexual Health
          </h3>
          <p class="text-slate-600 text-sm">
            Compare ED treatment services and medications.
          </p>
        </a>
        <a href="/testosterone" class="card-hover p-6 group">
          <div class="mb-3 flex justify-center">
            <Icon name="testosterone" class="w-8 h-8 text-blue-600" />
          </div>
          <h3 class="font-semibold text-lg mb-2 text-slate-900 group-hover:text-brand-accent transition-colors">
            Testosterone & Hormones
          </h3>
          <p class="text-slate-600 text-sm">
            TRT clinics and hormone optimization services.
          </p>
        </a>
        <a href="/weight-loss" class="card-hover p-6 group">
          <div class="mb-3 flex justify-center">
            <Icon name="weight-loss" class="w-8 h-8 text-purple-600" />
          </div>
          <h3 class="font-semibold text-lg mb-2 text-slate-900 group-hover:text-brand-accent transition-colors">
            Weight Loss
          </h3>
          <p class="text-slate-600 text-sm">
            GLP-1 medications and weight management programs.
          </p>
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
